###############################################################################
#
# Blueprint for PCI-DSS v4.0.1 Control Baseline for Red Hat Enterprise Linux 9
#
# Profile Description:
# Payment Card Industry - Data Security Standard (PCI-DSS) is a set of
# security standards designed to ensure the secure handling of payment card
# data, with the goal of preventing data breaches and protecting sensitive
# financial information.
# This profile ensures Red Hat Enterprise Linux 9 is configured in alignment
# with PCI-DSS v4.0.1 requirements.
#
# Profile ID:  xccdf_org.ssgproject.content_profile_pci-dss
# Benchmark ID:  xccdf_org.ssgproject.content_benchmark_RHEL-9
# Benchmark Version:  0.1.76
# XCCDF Version:  1.2
#
# This file was generated by OpenSCAP 1.3.10 using:
# $ oscap xccdf generate fix --profile xccdf_org.ssgproject.content_profile_pci-dss --fix-type blueprint xccdf-file.xml
#
# This Blueprint is generated from an OpenSCAP profile without preliminary evaluation.
# It attempts to fix every selected rule, even if the system is already compliant.
#
# How to apply this Blueprint:
# composer-cli blueprints push blueprint.toml
#
###############################################################################

name = "rhel9-pci-dss"
description = "PCI-DSS v4.0.1 Control Baseline for Red Hat Enterprise Linux 9"
version = "0.1.76"

[customizations.openscap]
profile_id = "xccdf_org.ssgproject.content_profile_pci-dss"
# If your hardening data stream is not part of the 'scap-security-guide' package
# provide the absolute path to it (from the root of the image filesystem).
# datastream = "/usr/share/xml/scap/ssg/content/ssg-xxxxx-ds.xml"

[[packages]]
name = "bind-utils"

[[packages]]
name = "vim"

[[packages]]
name = "chrony"

[[packages]]
name = "lvm2"

[[packages]]
name = "wget"

[[packages]]
name = "git"

[[packages]]
name = "openssh-server"

[[packages]]
name = "bash-completion"

[[packages]]
name = "firewalld"

[[packages]]
name = "openscap-scanner"

[[packages]]
name = "openscap-utils"

[[packages]]
name = "scap-security-guide"

[[packages]]
name = "insights-client"

[[packages]]
name = "rhc"

[[packages]]
name = "rhc-worker-playbook"

[[packages]]
name = "glibc-langpack-en"

[[packages]]
name = "langpacks-en"

[[packages]]
name = "ansible-core"

[[packages]]
name = "rhel-system-roles"

[[packages]]
name = "aide"
version = "*"

[[packages]]
name = "sudo"
version = "*"

[[packages]]
name = "cryptsetup"
version = "*"

[[packages]]
name = "logrotate"
version = "*"

[[packages]]
name = "nftables"
version = "*"

[[packages]]
name = "libselinux"
version = "*"

[[packages]]
name = "cronie"
version = "*"

[[packages]]
name = "chrony"
version = "*"

[[packages]]
name = "audispd-plugins"
version = "*"

[[packages]]
name = "audit"
version = "*"

[customizations]

[[customizations.user]]
name = "rexuser"
password = "r3dh4t1!" #Not secret
key = "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDkjHg5K0fG2Pw3sm5fyAVZ0j1zhlzb3urZavUjO0wmjdwKmclya4er7d6xCP1XpMp1EcXgYA2Svbnz8eyMUCgjHOq2+e/ccrfr/U65xNWORl62c/63KlpQHrRUK7EtRJHDu8tx2WNV43kSqyyua2uuS/ydzyDVhrrSf8IqRn4pkaL6+bJxcNUNNyUrs/yBogRUfue0CPEDXj8gCTbn8jlVLA+ts/D6ayORM1WSJU8iVfkBsLclZ5OfuoMYiwRzWJ30ekal/t+9yzTS3RNt6BXHIqLkcrGoEag/ZA4FCx5JVOQWdfApJtoExNejsTqpkRh+Z33dBRCNbIfXXxoaNWa3VdMYBXeRfpPQ5HbdPuZMdg2wKBNBTcYxc5qdmka6CVD3484Oh0hUigM0TJZKWtZ6vphqOjdFDsYNVA5+BXA5R14T0Q+cAuAhF6NnuwsAbfCvMsr3YfdvXwJgdCNFo4nvajqvIZE/ZKwP7FbZ56M4drDH0DfkIxZfbbBFIRxlX0BnpgMJH31XNRVhDM2PPSKRE2yi6+da13rhhZs8/WcZc0snvsASydOMEeX9bDwq1/qkbkezhhFsSZz9yCvWgYg1P03vlACmcgvDDHApnMx7IgTtyTIjbOEiklvwcuB9Qhs9fXc3iCNHLrKcqVSfUVvZj+y/BXFkS6I6p4TGmOjlfQ=="
groups = ["wheel"]
uid = 5001

[customizations.timezone]
timezone = "Europe/Stockholm"
ntpservers = ["0.rhel.pool.ntp.org", "1.rhel.pool.ntp.org"]

[customizations.locale]
languages = ["en_US.UTF-8"]
keyboard = "sv-latin1"

[customizations.kernel]
append = "audit_backlog_limit=8192 audit=1"

[customizations.services]
enabled = ["auditd","firewalld","cockpit.socket","sshd.service"]
disabled = []
masked = ["rsyncd","rpcbind","avahi-daemon","nftables"]

[customizations.firewall]
[customizations.firewall.services]
enabled = ["cockpit", "ssh"]

[[customizations.filesystem]]
mountpoint = "/boot"
size = "1 GiB"

[[customizations.filesystem]]
mountpoint = "/"
size = "4 GiB"

[[customizations.filesystem]]
mountpoint = "/home"
size = "2 GiB"

[[customizations.filesystem]]
mountpoint = "/tmp"
size = "2 GiB"

[[customizations.filesystem]]
mountpoint = "/var"
size = "6 GiB"

[[customizations.filesystem]]
mountpoint = "/var/log"
size = "6 GiB"

[[customizations.filesystem]]
mountpoint = "/var/log/audit"
size = "7 GiB"

[[customizations.filesystem]]
mountpoint = "/var/tmp"
size = "2 GiB"



